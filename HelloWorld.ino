/*
Hello, World! example
June 11, 2015
Copyright (C) 2015 David Martinez
All rights reserved.
This code is the most basic barebones code for writing a program for Arduboy.

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.
*/

#include "Arduboy.h"
//#include "bitmaps.ino"

#include "Arduboy.h"


PROGMEM const unsigned char fighter[][32] =
{
 {//fighter1
  0x00, 0x00, 0x00, 0x80, 0x40, 0x78, 0x78, 0x68,
  0x78, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x40, 0x73, 0x4b, 0x67, 0x14, 0x0c,
  0x14, 0x67, 0x4b, 0x70, 0x40, 0x00, 0x00, 0x00,
 },
 {//fighter2
  0x00, 0x00, 0x00, 0x80, 0xc0, 0xf8, 0x78, 0x68,
  0x78, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x40, 0x71, 0x49, 0x67, 0x14, 0x0c,
  0x14, 0x67, 0x49, 0x70, 0x40, 0x00, 0x00, 0x00,
 },
 {//fighter3
  0x00, 0x00, 0x00, 0xc0, 0xa0, 0xbc, 0x3c, 0x34,
  0x3c, 0xc0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x40, 0x71, 0x4b, 0x65, 0x14, 0x0c,
  0x14, 0x67, 0x49, 0x70, 0x40, 0x00, 0x00, 0x00,
 },
 {//fighter4
  0x00, 0x00, 0x00, 0xc0, 0x20, 0x3c, 0x3c, 0x34,
  0x3c, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x40, 0x73, 0x4b, 0x67, 0x14, 0x0c,
  0x14, 0x67, 0x4b, 0x70, 0x40, 0x00, 0x00, 0x00,
 }
};

PROGMEM const unsigned char blob[][32] = 
{
  {//blob1 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x38, 0x44, 0x9a, 0x82, 0x9a, 0x82,
    0x82, 0x82, 0x82, 0x84, 0x48, 0x30, 0x00, 0x00,
  },
  {//blob2
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x3c, 0x42, 0x99, 0x81, 0x99, 0x81,
    0x81, 0x81, 0x81, 0x82, 0x44, 0x38, 0x00, 0x00,
  },
  {//blob3
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x3c, 0x42, 0x8d, 0x81, 0x8d, 0x81,
    0x81, 0x81, 0x81, 0x82, 0x44, 0x38, 0x00, 0x00,
  },
  {//blob4
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x38, 0x44, 0x8e, 0x82, 0x8e, 0x82,
    0x82, 0x82, 0x82, 0x84, 0x48, 0x30, 0x00, 0x00,
  }
};

int aniNum = 0;

// make an instance of arduboy used for many functions
Arduboy arduboy;

// This function runs once in your game.
// use it for anything that needs to be set only once in your game.
void setup() {
  // initiate arduboy instance
  arduboy.begin();

  // here we set the framerate to 15, we do not need to run at
  // default 60 and it saves us battery life
  arduboy.setFrameRate(15);

  // first we clear our screen to black
  arduboy.clear();

  // we set our cursor 5 pixels to the right and 10 down from the top
  // (positions start at 0, 0) 
  arduboy.setCursor(4, 9);

  // then we print to screen what is in the Quotation marks ""
  arduboy.print(F("Welcome to"));
  arduboy.setCursor(4, 19);
  arduboy.print(F("Arduboy RPG!"));
  //arduboy.setCursor(4, 29);
  //arduboy.print(F("It works!"));
  arduboy.setCursor(4, 39);
  arduboy.print(F("Press 'A' to begin."));
  
  // then we finaly we tell the arduboy to display what we just wrote to the display
  arduboy.display();
}


// our main game loop, this runs once every cycle/frame.
// this is where our game logic goes.
void loop() {
  // pause render until it's time for the next frame
  if (!(arduboy.nextFrame()))
    return;

  while(not(arduboy.pressed(A_BUTTON))) {
    // Do something awesome  
  }
  
  // first we clear our screen to black
  arduboy.clear();
  arduboy.drawRoundRect(0, 5, 86, 25, 3, 1);
  arduboy.drawRoundRect(85, 5, 43, 25, 3, 1);
  // then we finaly we tell the arduboy to display what we just wrote to the display
  arduboy.display();
  
  if (!(arduboy.nextFrame())) return;
  
  arduboy.clear();
  arduboy.drawRoundRect(0, 5, 86, 25, 3, 1);
  arduboy.drawRoundRect(85, 5, 43, 25, 3, 1);
  arduboy.drawBitmap(5, 45, bitmaps.fighter[aniNum], 16, 16, WHITE);
  
  if (arduboy.everyXFrames(5)) aniNum++;
  if (aniNum == 4)aniNum = 0;
  
  arduboy.display();
}

